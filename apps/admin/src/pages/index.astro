---
import Layout from '../layouts/Layout.astro'

const API_URL = 'http://localhost:3000'

// Fetch summary stats
let stats = {
  tenants: 0,
  agents: 0,
  websites: 0,
  content: 0,
}

try {
  const response = await fetch(`${API_URL}/health`)
  if (response.ok) {
    // In a real implementation, we'd have a stats endpoint
    stats = {
      tenants: 1, // Placeholder
      agents: 4,
      websites: 1,
      content: 5,
    }
  }
} catch (error) {
  console.log('Backend not available')
}
---

<Layout title="Dashboard">
  <div>
    <h1 class="text-3xl font-bold text-gray-900 mb-8">Dashboard</h1>

    <!-- Stats Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-600">Media Houses</p>
            <p class="text-3xl font-bold text-gray-900 mt-2">{stats.tenants}</p>
          </div>
          <div class="text-4xl">ğŸ¢</div>
        </div>
        <a href="/tenants" class="text-sm text-blue-600 hover:underline mt-4 inline-block">
          Manage â†’
        </a>
      </div>

      <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-600">AI Agents</p>
            <p class="text-3xl font-bold text-gray-900 mt-2">{stats.agents}</p>
          </div>
          <div class="text-4xl">ğŸ¤–</div>
        </div>
        <a href="/agents" class="text-sm text-blue-600 hover:underline mt-4 inline-block">
          Manage â†’
        </a>
      </div>

      <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-600">Websites</p>
            <p class="text-3xl font-bold text-gray-900 mt-2">{stats.websites}</p>
          </div>
          <div class="text-4xl">ğŸŒ</div>
        </div>
        <a href="/websites" class="text-sm text-blue-600 hover:underline mt-4 inline-block">
          Manage â†’
        </a>
      </div>

      <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm text-gray-600">Content Items</p>
            <p class="text-3xl font-bold text-gray-900 mt-2">{stats.content}</p>
          </div>
          <div class="text-4xl">ğŸ“</div>
        </div>
        <a href="/content" class="text-sm text-blue-600 hover:underline mt-4 inline-block">
          Manage â†’
        </a>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="bg-white rounded-lg shadow p-6 mb-8">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Quick Actions</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <a
          href="/tenants/new"
          class="block p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition text-center"
        >
          <div class="text-3xl mb-2">â•</div>
          <div class="font-medium text-gray-900">Create Media House</div>
          <div class="text-sm text-gray-600 mt-1">Start a new virtual media house</div>
        </a>

        <a
          href="/agents/new"
          class="block p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition text-center"
        >
          <div class="text-3xl mb-2">ğŸ¤–</div>
          <div class="font-medium text-gray-900">Add AI Agent</div>
          <div class="text-sm text-gray-600 mt-1">Create a new agent employee</div>
        </a>

        <a
          href="/websites/new"
          class="block p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition text-center"
        >
          <div class="text-3xl mb-2">ğŸŒ</div>
          <div class="font-medium text-gray-900">Add Website</div>
          <div class="text-sm text-gray-600 mt-1">Create a new media property</div>
        </a>
      </div>
    </div>

    <!-- System Status -->
    <div class="bg-white rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">System Status</h2>
      <div class="space-y-3">
        <div class="flex items-center justify-between">
          <span class="text-gray-700">Backend API</span>
          <span class="flex items-center text-green-600">
            <span class="w-2 h-2 bg-green-600 rounded-full mr-2"></span>
            Online
          </span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-700">Database</span>
          <span class="flex items-center text-green-600">
            <span class="w-2 h-2 bg-green-600 rounded-full mr-2"></span>
            Connected
          </span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-700">Event Bus (NATS)</span>
          <span class="flex items-center text-green-600">
            <span class="w-2 h-2 bg-green-600 rounded-full mr-2"></span>
            Connected
          </span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-700">Workflows (Temporal)</span>
          <span class="flex items-center text-green-600">
            <span class="w-2 h-2 bg-green-600 rounded-full mr-2"></span>
            Running
          </span>
        </div>
      </div>

      <div class="mt-6 pt-6 border-t border-gray-200">
        <div class="flex items-center justify-between text-sm">
          <span class="text-gray-600">Monitoring Dashboard</span>
          <a
            href="http://localhost:3001"
            target="_blank"
            class="text-blue-600 hover:underline"
          >
            Open Dashboard â†’
          </a>
        </div>
      </div>
    </div>
  </div>
</Layout>
