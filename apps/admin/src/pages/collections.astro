---
/**
 * Collections Browser Page
 * View-only browser for collection data (restaurants, accommodations, etc.)
 * Data is fetched from the GitHub content repository
 */
import Layout from '../layouts/Layout.astro'
import { getSessionContext } from '../lib/session'
import { CollectionBrowser } from '../components/collections'

const title = 'Collections'

// Get the selected product (website) from session
const session = getSessionContext(Astro.cookies)
const websiteId = session.productId
---

<Layout title={title}>
  <div class="flex flex-col h-screen">
    <!-- Hidden input to pass websiteId to client-side JS -->
    <input type="hidden" id="selected-website-id" value={websiteId || ''} />

    {websiteId ? (
      <div id="collections-container" class="flex-1">
        <CollectionBrowser client:load websiteId={websiteId} />
      </div>
    ) : (
      <div class="flex items-center justify-center h-full">
        <div class="text-center">
          <h2 class="text-xl font-semibold mb-2">No Website Selected</h2>
          <p class="text-muted-foreground mb-4">
            Please select a website from the sidebar to browse collections.
          </p>
          <a href="/websites" class="text-primary hover:underline">
            Go to Websites
          </a>
        </div>
      </div>
    )}
  </div>
</Layout>

<style>
  #collections-container {
    height: calc(100vh - 64px); /* Subtract header height */
  }
</style>
