---
/**
 * HeaderSimple Component
 * A clean, simple header with logo, navigation, and optional CTA button.
 *
 * CUSTOMIZATION: Replace the HTML below with your preferred Tailwind Plus header.
 * Keep the props interface and data bindings intact.
 */

import type { NavItem, CtaButton, SocialLink } from '../../../schemas'

export interface Props {
  /** Site name displayed in header */
  siteName: string
  /** Optional logo URL */
  logo?: string
  /** Base URL for the site */
  baseUrl: string
  /** Main navigation items */
  navItems: NavItem[]
  /** Optional CTA button */
  ctaButton?: CtaButton
  /** Social links (optional, usually in footer) */
  socialLinks?: SocialLink[]
  /** Whether header should be sticky */
  sticky?: boolean
  /** Whether header should be transparent on hero sections */
  transparentOnHero?: boolean
  /** Current language for localization */
  lang?: string
}

const {
  siteName,
  logo,
  baseUrl,
  navItems,
  ctaButton,
  socialLinks = [],
  sticky = false,
  transparentOnHero = false,
  lang = 'en',
} = Astro.props

// Helper to get localized title
function getTitle(item: NavItem): string {
  if (item.titles && item.titles[lang]) {
    return item.titles[lang]
  }
  return item.title
}

// Helper to render link attributes
function getLinkAttrs(item: { url?: string; external?: boolean }) {
  const attrs: Record<string, string> = {}
  if (item.url) attrs.href = item.url
  if (item.external) {
    attrs.target = '_blank'
    attrs.rel = 'noopener noreferrer'
  }
  return attrs
}
---

<!--
  ============================================================================
  HEADER SIMPLE COMPONENT
  ============================================================================

  This is a scaffolded component. You can replace the HTML below with any
  Tailwind Plus header component. Keep the data bindings like {siteName},
  {navItems.map(...)}, etc.

  Tailwind Plus headers: https://tailwindcss.com/plus/ui-blocks/marketing/headers
  ============================================================================
-->

<header
  class:list={[
    'border-b border-gray-200 bg-white',
    { 'sticky top-0 z-50': sticky },
    { 'bg-transparent absolute inset-x-0 top-0 z-50': transparentOnHero },
  ]}
>
  <nav class="mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8" aria-label="Global">
    <!-- Logo -->
    <div class="flex lg:flex-1">
      <a href="/" class="-m-1.5 p-1.5">
        <span class="sr-only">{siteName}</span>
        {logo ? (
          <img class="h-8 w-auto" src={logo} alt={siteName} />
        ) : (
          <span class="text-xl font-bold text-gray-900">{siteName}</span>
        )}
      </a>
    </div>

    <!-- Mobile menu button -->
    <div class="flex lg:hidden">
      <button
        type="button"
        class="-m-2.5 inline-flex items-center justify-center rounded-md p-2.5 text-gray-700"
        aria-label="Open main menu"
      >
        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
      </button>
    </div>

    <!-- Desktop navigation -->
    <div class="hidden lg:flex lg:gap-x-12">
      {navItems.map((item) => (
        item.children && item.children.length > 0 ? (
          <!-- Dropdown menu item -->
          <div class="relative group">
            <button
              type="button"
              class="flex items-center gap-x-1 text-sm font-semibold leading-6 text-gray-900"
            >
              {getTitle(item)}
              <svg class="h-5 w-5 flex-none text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
              </svg>
            </button>

            <!-- Dropdown panel -->
            <div class="absolute -left-8 top-full z-10 hidden group-hover:block mt-3 w-screen max-w-md overflow-hidden rounded-3xl bg-white shadow-lg ring-1 ring-gray-900/5">
              <div class="p-4">
                {item.children.map((child) => (
                  <div class="group/item relative flex items-center gap-x-6 rounded-lg p-4 text-sm leading-6 hover:bg-gray-50">
                    {child.icon && (
                      <div class="flex h-11 w-11 flex-none items-center justify-center rounded-lg bg-gray-50 group-hover/item:bg-white">
                        <span class="text-gray-600 group-hover/item:text-primary-600">{child.icon}</span>
                      </div>
                    )}
                    <div class="flex-auto">
                      <a {...getLinkAttrs(child)} class="block font-semibold text-gray-900">
                        {getTitle(child)}
                        <span class="absolute inset-0"></span>
                      </a>
                      {child.description && (
                        <p class="mt-1 text-gray-600">{child.description}</p>
                      )}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        ) : (
          <!-- Simple link -->
          <a
            {...getLinkAttrs(item)}
            class:list={[
              'text-sm font-semibold leading-6',
              item.highlight ? 'text-primary-600' : 'text-gray-900 hover:text-gray-600',
            ]}
          >
            {getTitle(item)}
          </a>
        )
      ))}
    </div>

    <!-- CTA Button -->
    <div class="hidden lg:flex lg:flex-1 lg:justify-end">
      {ctaButton && (
        <a
          href={ctaButton.url}
          target={ctaButton.external ? '_blank' : undefined}
          rel={ctaButton.external ? 'noopener noreferrer' : undefined}
          class:list={[
            'rounded-md px-3.5 py-2.5 text-sm font-semibold shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2',
            ctaButton.variant === 'primary' && 'bg-primary-600 text-white hover:bg-primary-500 focus-visible:outline-primary-600',
            ctaButton.variant === 'secondary' && 'bg-secondary-600 text-white hover:bg-secondary-500 focus-visible:outline-secondary-600',
            ctaButton.variant === 'outline' && 'ring-1 ring-inset ring-gray-300 text-gray-900 hover:bg-gray-50',
            ctaButton.variant === 'ghost' && 'text-gray-900 hover:text-gray-600',
          ]}
        >
          {ctaButton.texts?.[lang] || ctaButton.text}
        </a>
      )}
    </div>
  </nav>
</header>
